language: python
python:
- '3.8'
cache: false
install:
- python -V
- pip install -U virtualenv
- virtualenv venv
- source venv/bin/activate
- pip install -U flit
- pip install -U pytest
- pip install -U mypy
- pip install -U yaqc
- pip install -U yaqd-core
- pip install -U yaq-traits
- pip install .
jobs:
  include:
  - stage: test
    name: mypy
    script: mypy yaqd_wright
  - stage: test
    name: entry-points
    script:
    - yaqd-wright-wl-motor --version
    - yaqd-wright-wl-motor -h
    - yaqd-wright-filter-wheel --version
    - yaqd-wright-filter-wheel -h
    - yaqd-wright-aerotech --version
    - yaqd-wright-aerotech -h
    - yaqd-wright-ingaas --version
    - yaqd-wright-ingaas -h
  - stage: test
    name: traits
    script: for i in yaqd_wright/*.avpr; do yaq-traits check $i; done
deploy:
  provider: script
  script: flit publish
  on:
    tags: true
  skip_cleanup: true
env:
  global:
  - secure: aAYwNuG6+rO7pI8LgA5eAwRWcAFWX6FLCeT2Lzzn37wzpkxr9jmKFlKza5JbRq0R7RjJp/g8TPkGa0vILjqjZf5Yf2WjQM+u4QVtmF9x2qGb6+GH+880oerj4NphqwIvCIVW8mYWfJ2MZKnh8uBiYl5k+1N/Wu3APxQlOvhGOyWcuq2EAoaPS+09MTDwMHbjTy0M2WkoyE2jBUbTYniHFTewRz9GIJd8X45g6YWJ95oOwOjrOH7MiTcyRW3GLklgZvz2Mx0ewrx63RFzaWQvMw+EtbAeajgWthizES5PM0STLEWTJTPc436FRu6qdGTbXBFPrtQ+1gduxFMDv5QsJ4Z+jJGoCtFabPbhIoF2ROtFIV58hrZeh0EIDSGZRljE+3vH1mhmAowB4Y0s2SPK8K7OXAwQ4Cjqc5jtKQTSMxQ1l1tmULbt0SPgejdhASCWuM6OwEjljVdSyyQC380g1iWpahP7ovJo/LG0UDRFtoM+TVrSOx7MHUXHlFVb1xAS3QTnMlKRscYQfaotnv2igNK0hh852zoQMVIvKQuaVXc84mnPN/w0PByNxj/1tnqs84QiU9/5KnoV0EpWpSqgGiDXcfDqVWT1YVKQzD8qY6b0EvUfb6mVBNBhmE1dsIFlkVUI8gkR3sKnO/yNf5yTqD6Lx5jX0uMGp6RKNxqgQn0=
  - secure: WtCH2dz0eDi5snSL0xAmqJMOwlz4yWu9IKCtSAZEu4+li76W02IdVrT0qxceSAO+IciRo+IrYMUVvu8sz5LPaOS2aXiWlmLeuSCU4Ar02w8h6F6QV1IghqJOFhBTI8STg+tX7ONcKzgJgc/POkpvAzfynegAtki7kvNQ/jNllxZaKqObWyOOvyL1wxF+OA1Dr+POoUIssslNZU6gzPuec8KH0zJ6WhbrxrHnECcmx0FdfChCxhsLQz30S/PP9gi8m2xhzEX7yHUswaaK1JfSX1Viq+DmuDVnh7ZTKRstoekX7ZD43rb6P52/rUiaCCa5P5srxzBOU8G2CXjlGton78GBQxhKOHFA/FftNUysv/umdEDQ/HCypRc7H6hzcQ5SWceNJ0DOrKT/JqU+MxGPDUeGArrplObPvnYujsgcP4M4ZfcWdsngIuy6iGAweiN3tYP1X6tqhNUMUTKV/1AXvldy9h67dBnfNZ+3+X3FIxPbfSvEgYW3lYSD1Ys8IWYFNXDNzr1UlcoxR+WzPp7hTmiC3z279dfOF9d7E4zT3YTQ+w4u+k5ngf7rnuBFOmYqxQAwdfUyfvh5wPDflnJHE8o8JqEHZ3QokImwu1H+Xpws4WB8Gd/wJ+0QZh6vnnbIN9Rord08Gm4rkhe91lNzMMLb9KVvcEJ1XumniJ5CFWU=
